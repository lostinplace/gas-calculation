(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     68547,       1699]
NotebookOptionsPosition[     65250,       1645]
NotebookOutlinePosition[     65647,       1661]
CellTagsIndexPosition[     65604,       1658]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", "n_", "]"}], "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"n", " ", 
    RowBox[{"Count", "[", 
     RowBox[{"e", ",", " ", 
      RowBox[{"_ArcCosh", " ", "|", " ", "_ArcCot", "|", "\[ImaginaryI]"}], 
      ",", "Infinity"}], "]"}]}], "+", 
   RowBox[{"LeafCount", "[", "e", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"assumptions", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", ">", 
     RowBox[{"r", "+", "1"}]}], ",", " ", 
    RowBox[{"z", ">", 
     RowBox[{"x", "-", "r"}]}], ",", " ", 
    RowBox[{"z", ">", "n"}], ",", " ", 
    RowBox[{"n", ">", " ", 
     RowBox[{"r", "+", " ", "1"}]}], ",", " ", 
    RowBox[{"r", ">", "0"}], ",", " ", "Reals"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"simplifiers", " ", "=", " ", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "+", 
      SuperscriptBox["r", "2"], "-", "z", "-", 
      RowBox[{"2", " ", "r", " ", "z"}], "+", 
      SuperscriptBox["z", "2"]}], " ", "\[Rule]", " ", 
     RowBox[{"Factor", "[", 
      RowBox[{"r", "+", 
       SuperscriptBox["r", "2"], "-", "z", "-", 
       RowBox[{"2", " ", "r", " ", "z"}], "+", 
       SuperscriptBox["z", "2"]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", "r"}], "-", 
      SuperscriptBox["r", "2"], "+", 
      SuperscriptBox["z", "2"]}], " ", "\[Rule]", " ", 
     RowBox[{"Factor", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "-", 
       RowBox[{"2", " ", "r"}], "-", 
       SuperscriptBox["r", "2"], "+", 
       SuperscriptBox["z", "2"]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       RowBox[{"1", "+", "r"}], "z"]}], " ", "\[Rule]", " ", 
     RowBox[{"Factor", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       FractionBox[
        RowBox[{"1", "+", "r"}], "z"]}], "]"}]}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], "2"], 
       SuperscriptBox["z", "2"]]}], " ", "\[Rule]", " ", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", " ", "+", "r", " ", "-", "z"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}]}], 
      SuperscriptBox["z", "2"]]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "r", "+", "z"}], ")"}]}], ")"}]}], " ", "\[Rule]", 
     " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z", "-", "1", "-", "r"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["n", "2"], "-", 
      RowBox[{"2", " ", "r"}], "-", 
      SuperscriptBox["r", "2"]}], " ", "\[Rule]", " ", 
     RowBox[{"Factor", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["n", "2"], "-", 
       RowBox[{"2", " ", "r"}], "-", 
       SuperscriptBox["r", "2"]}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["n", "2"], "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "r"}], ")"}], "2"]}], " ", "\[Rule]", " ", 
     RowBox[{"Factor", "[", 
      RowBox[{
       SuperscriptBox["n", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "2"]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
      SuperscriptBox["z", "2"]}], " ", "\[Rule]", " ", 
     RowBox[{"Factor", "[", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
       SuperscriptBox["z", "2"]}], "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r"}], ")"}], " ", 
       SubscriptBox["A", "1"]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r"}], ")"}], " ", 
       SubscriptBox["B", "1"]}]}], " ", "\[Rule]", "  ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["A", "1"], "-", 
        SubscriptBox["B", "1"]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{"D", ",", "x_"}], "]"}], " ", "-", " ", 
      RowBox[{"Times", "[", 
       RowBox[{"D", ",", " ", "y_"}], "]"}]}], " ", "\[Rule]", " ", 
     RowBox[{"D", " ", "*", " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", "y"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcCot", "[", "x_", "]"}], "\[Rule]", " ", 
     RowBox[{"ArcTan", "[", 
      FractionBox["1", "x"], "]"}]}]}], "\[IndentingNewLine]", 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"vars", " ", "=", " ", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], " ", "\[Rule]", " ", 
     "A"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]], " ", "\[Rule]", " ", 
     "B"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "-", "z"}], " ", "\[Rule]", " ", "C"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", "\[Rule]", " ", "D"}]}], 
   "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"replacements", " ", "=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"simplifiers", ",", " ", "vars"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Repl", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"ReplaceRepeated", "[", 
   RowBox[{"x", ",", " ", "replacements"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Refn", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"Refine", "[", 
   RowBox[{"x", ",", " ", "assumptions"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RefnRepl", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"repl", "[", 
   RowBox[{"refn", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<end headers\>\"", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.819732117549864*^9, {3.8197322258359823`*^9, 3.8197323574191933`*^9}, {
   3.819732413821748*^9, 3.8197324142066793`*^9}, {3.8197324755783367`*^9, 
   3.8197325243759003`*^9}, {3.819732588147958*^9, 3.819732622348461*^9}, {
   3.819732721734293*^9, 3.8197327288219013`*^9}, {3.8197331704245663`*^9, 
   3.819733176877939*^9}, {3.819733236410554*^9, 3.819733244768585*^9}, {
   3.819733278701783*^9, 3.819733301052435*^9}, 3.8197434651270123`*^9, {
   3.819743499929562*^9, 3.8197436440226097`*^9}, {3.819743868676826*^9, 
   3.819743875843301*^9}, {3.819743958472179*^9, 3.819743967455584*^9}, {
   3.819744196802289*^9, 3.819744225048049*^9}, {3.8197446215796757`*^9, 
   3.8197446322773523`*^9}, {3.8197446741855803`*^9, 
   3.8197447209027357`*^9}, {3.819744753696114*^9, 3.819744766074801*^9}, {
   3.819745101864459*^9, 3.8197452352688007`*^9}, 3.819745352794034*^9, {
   3.819745404409896*^9, 3.819745433117364*^9}, {3.819745472185542*^9, 
   3.819745472527425*^9}, {3.819745518053076*^9, 3.819745530295866*^9}, {
   3.819800108507004*^9, 3.81980013887418*^9}, {3.819800254174932*^9, 
   3.8198003217013493`*^9}, {3.81980037402096*^9, 3.819800380037395*^9}, {
   3.819800790208826*^9, 3.819800797062772*^9}, {3.819800900841584*^9, 
   3.819800907652759*^9}, {3.819801623521516*^9, 3.8198016275817204`*^9}, {
   3.819801718574246*^9, 3.81980174632152*^9}, {3.819804638365535*^9, 
   3.8198046527022142`*^9}, {3.8198048622949*^9, 3.819804878295332*^9}, {
   3.8198049382654676`*^9, 3.81980495577273*^9}, {3.8198052066460876`*^9, 
   3.819805211587111*^9}, 3.819805336231073*^9, {3.819805623748378*^9, 
   3.819805630092121*^9}, {3.8198056686104937`*^9, 3.819805674804199*^9}, {
   3.8198057482878227`*^9, 3.8198057542374287`*^9}, {3.819805799597425*^9, 
   3.8198058012106237`*^9}, {3.819806117960475*^9, 3.8198061407339973`*^9}, {
   3.819806178519053*^9, 3.8198062694465017`*^9}, {3.819806977969499*^9, 
   3.8198069979195547`*^9}, {3.8198070361756268`*^9, 3.819807076526429*^9}, {
   3.8198071188682423`*^9, 3.819807130507658*^9}, {3.819807170809897*^9, 
   3.8198071798277817`*^9}, {3.819807225048123*^9, 3.8198072536718197`*^9}, {
   3.819809476477572*^9, 3.8198095048336487`*^9}, {3.819809818224366*^9, 
   3.819809832246868*^9}, {3.819813287932341*^9, 3.819813294936118*^9}, {
   3.819813352291892*^9, 3.819813378355753*^9}, {3.819813478543869*^9, 
   3.819813484285652*^9}, {3.8198135200044317`*^9, 3.819813568543895*^9}, {
   3.819814046517503*^9, 3.819814129223158*^9}, {3.819814513833898*^9, 
   3.819814597657181*^9}, 3.8198146785467443`*^9, 3.8198148915197573`*^9},
 CellLabel->
  "In[1476]:=",ExpressionUUID->"8cbcca89-dd83-403d-b485-37075ac2cd63"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", ">", 
    RowBox[{"1", "+", "r"}]}], ",", 
   RowBox[{"z", ">", 
    RowBox[{
     RowBox[{"-", "r"}], "+", "x"}]}], ",", 
   RowBox[{"z", ">", "n"}], ",", 
   RowBox[{"n", ">", 
    RowBox[{"1", "+", "r"}]}], ",", 
   RowBox[{"r", ">", "0"}], ",", 
   TemplateBox[{},
    "Reals"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8197452817415123`*^9, 3.819745355531226*^9, 3.819745454229978*^9, 
   3.819745532171616*^9, {3.819800258701486*^9, 3.81980028866358*^9}, 
   3.819800323369463*^9, 3.819800381965981*^9, 3.819800800876227*^9, 
   3.819800908837842*^9, 3.819802617072193*^9, 3.819804674892701*^9, 
   3.819804986430758*^9, 3.819805261342979*^9, {3.8198053266043797`*^9, 
   3.819805337191287*^9}, 3.819805631248234*^9, 3.819805676616289*^9, 
   3.8198059084725437`*^9, 3.819806274874732*^9, 3.8198070002176933`*^9, {
   3.819807049193378*^9, 3.81980707713214*^9}, 3.8198071862876673`*^9, 
   3.8198072866530247`*^9, {3.8198094900690613`*^9, 3.819809520448262*^9}, 
   3.819809833704899*^9, 3.819810117350868*^9, 3.819813299264287*^9, 
   3.819813381546403*^9, 3.8198135015339823`*^9, {3.819813544754035*^9, 
   3.819813571899763*^9}, 3.8198141311336327`*^9, 3.819814601883585*^9, 
   3.819814680502849*^9},
 CellLabel->
  "Out[1477]=",ExpressionUUID->"c944f348-52e8-4d44-8ba0-9f62cab65ad4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "+", 
     SuperscriptBox["r", "2"], "-", "z", "-", 
     RowBox[{"2", " ", "r", " ", "z"}], "+", 
     SuperscriptBox["z", "2"]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "-", "z"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "r", "-", "z"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"2", " ", "r"}], "-", 
     SuperscriptBox["r", "2"], "+", 
     SuperscriptBox["z", "2"]}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "+", "z"}], ")"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      RowBox[{"1", "+", "r"}], "z"]}], "\[Rule]", 
    FractionBox[
     RowBox[{"1", "+", "r", "-", "z"}], "z"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], "2"], 
      SuperscriptBox["z", "2"]]}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}]}], 
     SuperscriptBox["z", "2"]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "+", "z"}], ")"}]}], ")"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["n", "2"], "-", 
     RowBox[{"2", " ", "r"}], "-", 
     SuperscriptBox["r", "2"]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], "2"]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
     SuperscriptBox["z", "2"]}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "+", "z"}], ")"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], " ", 
      SubscriptBox["A", "1"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], " ", 
      SubscriptBox["B", "1"]}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "1"], "-", 
       SubscriptBox["B", "1"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"D", " ", "x_"}], "-", 
     RowBox[{"D", " ", "y_"}]}], "\[Rule]", 
    RowBox[{"D", " ", 
     RowBox[{"(", 
      RowBox[{"x", "-", "y"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"ArcCot", "[", "x_", "]"}], "\[Rule]", 
    RowBox[{"ArcTan", "[", 
     FractionBox["1", "x"], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8197452817415123`*^9, 3.819745355531226*^9, 3.819745454229978*^9, 
   3.819745532171616*^9, {3.819800258701486*^9, 3.81980028866358*^9}, 
   3.819800323369463*^9, 3.819800381965981*^9, 3.819800800876227*^9, 
   3.819800908837842*^9, 3.819802617072193*^9, 3.819804674892701*^9, 
   3.819804986430758*^9, 3.819805261342979*^9, {3.8198053266043797`*^9, 
   3.819805337191287*^9}, 3.819805631248234*^9, 3.819805676616289*^9, 
   3.8198059084725437`*^9, 3.819806274874732*^9, 3.8198070002176933`*^9, {
   3.819807049193378*^9, 3.81980707713214*^9}, 3.8198071862876673`*^9, 
   3.8198072866530247`*^9, {3.8198094900690613`*^9, 3.819809520448262*^9}, 
   3.819809833704899*^9, 3.819810117350868*^9, 3.819813299264287*^9, 
   3.819813381546403*^9, 3.8198135015339823`*^9, {3.819813544754035*^9, 
   3.819813571899763*^9}, 3.8198141311336327`*^9, 3.819814601883585*^9, 
   3.81981468051447*^9},
 CellLabel->
  "Out[1478]=",ExpressionUUID->"b2143da3-d971-474a-8292-52053f71750f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], "\[Rule]", "A"}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]], "\[Rule]", "B"}], ",", 
   RowBox[{
    RowBox[{"n", "-", "z"}], "\[Rule]", "C"}], ",", 
   RowBox[{
    RowBox[{"1", "+", "r"}], "\[Rule]", "D"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8197452817415123`*^9, 3.819745355531226*^9, 3.819745454229978*^9, 
   3.819745532171616*^9, {3.819800258701486*^9, 3.81980028866358*^9}, 
   3.819800323369463*^9, 3.819800381965981*^9, 3.819800800876227*^9, 
   3.819800908837842*^9, 3.819802617072193*^9, 3.819804674892701*^9, 
   3.819804986430758*^9, 3.819805261342979*^9, {3.8198053266043797`*^9, 
   3.819805337191287*^9}, 3.819805631248234*^9, 3.819805676616289*^9, 
   3.8198059084725437`*^9, 3.819806274874732*^9, 3.8198070002176933`*^9, {
   3.819807049193378*^9, 3.81980707713214*^9}, 3.8198071862876673`*^9, 
   3.8198072866530247`*^9, {3.8198094900690613`*^9, 3.819809520448262*^9}, 
   3.819809833704899*^9, 3.819810117350868*^9, 3.819813299264287*^9, 
   3.819813381546403*^9, 3.8198135015339823`*^9, {3.819813544754035*^9, 
   3.819813571899763*^9}, 3.8198141311336327`*^9, 3.819814601883585*^9, 
   3.819814680523303*^9},
 CellLabel->
  "Out[1479]=",ExpressionUUID->"f9433766-f49b-4b7d-ae5e-ac2620cc4f03"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "+", 
     SuperscriptBox["r", "2"], "-", "z", "-", 
     RowBox[{"2", " ", "r", " ", "z"}], "+", 
     SuperscriptBox["z", "2"]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "-", "z"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "r", "-", "z"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"2", " ", "r"}], "-", 
     SuperscriptBox["r", "2"], "+", 
     SuperscriptBox["z", "2"]}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "+", "z"}], ")"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      RowBox[{"1", "+", "r"}], "z"]}], "\[Rule]", 
    FractionBox[
     RowBox[{"1", "+", "r", "-", "z"}], "z"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], "2"], 
      SuperscriptBox["z", "2"]]}], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}]}], 
     SuperscriptBox["z", "2"]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "+", "z"}], ")"}]}], ")"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["n", "2"], "-", 
     RowBox[{"2", " ", "r"}], "-", 
     SuperscriptBox["r", "2"]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], "2"]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
     SuperscriptBox["z", "2"]}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "-", "z"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "r", "+", "z"}], ")"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], " ", 
      SubscriptBox["A", "1"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], " ", 
      SubscriptBox["B", "1"]}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["A", "1"], "-", 
       SubscriptBox["B", "1"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"D", " ", "x_"}], "-", 
     RowBox[{"D", " ", "y_"}]}], "\[Rule]", 
    RowBox[{"D", " ", 
     RowBox[{"(", 
      RowBox[{"x", "-", "y"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"ArcCot", "[", "x_", "]"}], "\[Rule]", 
    RowBox[{"ArcTan", "[", 
     FractionBox["1", "x"], "]"}]}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], "\[Rule]", "A"}], ",", 
   RowBox[{
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]], "\[Rule]", "B"}], ",", 
   RowBox[{
    RowBox[{"n", "-", "z"}], "\[Rule]", "C"}], ",", 
   RowBox[{
    RowBox[{"1", "+", "r"}], "\[Rule]", "D"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8197452817415123`*^9, 3.819745355531226*^9, 3.819745454229978*^9, 
   3.819745532171616*^9, {3.819800258701486*^9, 3.81980028866358*^9}, 
   3.819800323369463*^9, 3.819800381965981*^9, 3.819800800876227*^9, 
   3.819800908837842*^9, 3.819802617072193*^9, 3.819804674892701*^9, 
   3.819804986430758*^9, 3.819805261342979*^9, {3.8198053266043797`*^9, 
   3.819805337191287*^9}, 3.819805631248234*^9, 3.819805676616289*^9, 
   3.8198059084725437`*^9, 3.819806274874732*^9, 3.8198070002176933`*^9, {
   3.819807049193378*^9, 3.81980707713214*^9}, 3.8198071862876673`*^9, 
   3.8198072866530247`*^9, {3.8198094900690613`*^9, 3.819809520448262*^9}, 
   3.819809833704899*^9, 3.819810117350868*^9, 3.819813299264287*^9, 
   3.819813381546403*^9, 3.8198135015339823`*^9, {3.819813544754035*^9, 
   3.819813571899763*^9}, 3.8198141311336327`*^9, 3.819814601883585*^9, 
   3.819814680532199*^9},
 CellLabel->
  "Out[1480]=",ExpressionUUID->"6b170154-0f2a-494a-b236-06fe905ac6b6"],

Cell[BoxData["\<\"end headers\"\>"], "Print",
 CellChangeTimes->{
  3.81974463352831*^9, 3.819744723853978*^9, 3.8197447674739523`*^9, 
   3.8197452817547092`*^9, 3.819745355544572*^9, 3.8197454542455177`*^9, 
   3.819745532184904*^9, {3.819800258721036*^9, 3.8198002886764297`*^9}, 
   3.819800323390786*^9, 3.819800381980898*^9, 3.8198008008897038`*^9, 
   3.819800908852754*^9, 3.819802617089631*^9, 3.8198046749209137`*^9, 
   3.819804986452943*^9, 3.819805261365685*^9, {3.8198053266266823`*^9, 
   3.819805337209713*^9}, 3.819805631268506*^9, 3.8198056766370773`*^9, 
   3.819805908493658*^9, 3.819806274901422*^9, 3.8198070002467747`*^9, {
   3.819807049214562*^9, 3.8198070771543207`*^9}, 3.819807186311172*^9, 
   3.819807286676392*^9, {3.8198094900954237`*^9, 3.819809520473709*^9}, 
   3.819809833731489*^9, 3.819810117380169*^9, 3.8198132992940073`*^9, 
   3.819813381576179*^9, 3.819813501561966*^9, {3.819813544783132*^9, 
   3.819813571930958*^9}, 3.8198141311621923`*^9, 3.819814601911997*^9, 
   3.819814680540935*^9},
 CellLabel->
  "During evaluation of \
In[1476]:=",ExpressionUUID->"b09d4f75-5835-4e43-b5a8-d4d77c333955"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"probabilityFunction", " ", "=", " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"Cos", "[", 
     RowBox[{"ArcSin", "[", 
      FractionBox[
       RowBox[{"r", "+", "1"}], "x"], "]"}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<integral\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"probIntegral", " ", "=", " ", 
  RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
   RowBox[{"probabilityFunction", ",", " ", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "n", ",", " ", "z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "probIntegral", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\</integral\>\"", "]"}], "\[IndentingNewLine]"}], \
"Input",
 CellChangeTimes->{{3.81974520037142*^9, 3.819745242251307*^9}, {
   3.819802894794455*^9, 3.8198029294662437`*^9}, {3.8198034659020443`*^9, 
   3.819803488649591*^9}, {3.8198035234367657`*^9, 3.819803525583992*^9}, {
   3.819804269160947*^9, 3.819804274809044*^9}, 3.819805046514554*^9, 
   3.8198084792316628`*^9, {3.81980932560115*^9, 3.819809327435165*^9}},
 CellLabel->
  "In[1231]:=",ExpressionUUID->"128ab600-be19-4870-bcf0-2171b8ac8045"],

Cell[BoxData[
 RowBox[{"1", "-", 
  SqrtBox[
   RowBox[{"1", "-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], "2"], 
     SuperscriptBox["x", "2"]]}]]}]], "Output",
 CellChangeTimes->{3.819802637836123*^9, 3.8198034949605227`*^9, 
  3.819803534751927*^9, 3.8198042758996897`*^9, 3.8198049976214867`*^9, 
  3.8198050475233192`*^9, 3.8198084817165613`*^9, 3.819809328770754*^9, 
  3.819809526314262*^9, 3.819810130810629*^9, 3.819813079419281*^9},
 CellLabel->
  "Out[1231]=",ExpressionUUID->"7fd6ee20-967f-4302-9629-ff025628878f"],

Cell[BoxData["\<\"integral\"\>"], "Print",
 CellChangeTimes->{3.819802637844582*^9, 3.819803494970009*^9, 
  3.819803534760532*^9, 3.819804275909753*^9, 3.819804997632077*^9, 
  3.819805047533823*^9, 3.819808481730927*^9, 3.819809328779413*^9, 
  3.819809526322178*^9, 3.8198101308188477`*^9, 3.819813079433366*^9},
 CellLabel->
  "During evaluation of \
In[1231]:=",ExpressionUUID->"ed327bb1-8da4-429a-b486-b2e40b75df35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "n"}], "+", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["n", "2"], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], "2"]}]], "+", "z", "-", 
  SqrtBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
    SuperscriptBox["z", "2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "r"}], ")"}], " ", 
   RowBox[{"ArcCot", "[", 
    FractionBox[
     RowBox[{"1", "+", "r"}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["n", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "2"]}]]], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "r"}], ")"}], " ", 
   RowBox[{"ArcCot", "[", 
    FractionBox[
     RowBox[{"1", "+", "r"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
       SuperscriptBox["z", "2"]}]]], "]"}]}]}]], "Output",
 CellChangeTimes->{3.819802637836123*^9, 3.8198034949605227`*^9, 
  3.819803534751927*^9, 3.8198042758996897`*^9, 3.8198049976214867`*^9, 
  3.8198050475233192`*^9, 3.8198084817165613`*^9, 3.819809328770754*^9, 
  3.819809526314262*^9, 3.819810130810629*^9, 3.819813082844409*^9},
 CellLabel->
  "Out[1233]=",ExpressionUUID->"729f67fb-ddaf-4df2-8e3f-7377cb04af3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "n"}], "+", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["n", "2"], "-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], "2"]}]], "+", "z", "-", 
  SqrtBox[
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
    SuperscriptBox["z", "2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "r"}], ")"}], " ", 
   RowBox[{"ArcCot", "[", 
    FractionBox[
     RowBox[{"1", "+", "r"}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["n", "2"], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "2"]}]]], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "r"}], ")"}], " ", 
   RowBox[{"ArcCot", "[", 
    FractionBox[
     RowBox[{"1", "+", "r"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
       SuperscriptBox["z", "2"]}]]], "]"}]}]}]], "Output",
 CellChangeTimes->{3.819802637836123*^9, 3.8198034949605227`*^9, 
  3.819803534751927*^9, 3.8198042758996897`*^9, 3.8198049976214867`*^9, 
  3.8198050475233192`*^9, 3.8198084817165613`*^9, 3.819809328770754*^9, 
  3.819809526314262*^9, 3.819810130810629*^9, 3.819813082852171*^9},
 CellLabel->
  "Out[1234]=",ExpressionUUID->"88905828-75f9-4298-b53b-7a59560dec0b"],

Cell[BoxData["\<\"/integral\"\>"], "Print",
 CellChangeTimes->{3.819802637844582*^9, 3.819803494970009*^9, 
  3.819803534760532*^9, 3.819804275909753*^9, 3.819804997632077*^9, 
  3.819805047533823*^9, 3.819808481730927*^9, 3.819809328779413*^9, 
  3.819809526322178*^9, 3.8198101308188477`*^9, 3.8198130828609858`*^9},
 CellLabel->
  "During evaluation of \
In[1231]:=",ExpressionUUID->"c896b85f-87b2-4651-ae7a-2db844e298e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simplifiedNoTrig", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    FractionBox["probIntegral", 
     RowBox[{"z", "-", "n"}]], ",", " ", 
    RowBox[{"c", "[", "50", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8197437041090384`*^9, 3.819743718028451*^9}, {
   3.819743782582632*^9, 3.8197437923495283`*^9}, {3.8197445538376017`*^9, 
   3.819744554212034*^9}, {3.819744787760664*^9, 3.819744833102744*^9}, {
   3.819802938551407*^9, 3.819802938981578*^9}, {3.819804338630265*^9, 
   3.819804338836813*^9}, {3.819805296769103*^9, 3.819805316876993*^9}, {
   3.819805351319128*^9, 3.819805395469377*^9}, 3.819805426645871*^9, {
   3.81980984300476*^9, 3.8198098916884623`*^9}, 3.8198099245280733`*^9, {
   3.8198131018876877`*^9, 3.819813105083692*^9}},
 CellLabel->
  "In[1236]:=",ExpressionUUID->"4c229b05-061e-47f8-b766-32159dfaa5a5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "n"}], "+", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["n", "2"], "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "r"}], ")"}], "2"]}]], "+", "z", "-", 
   SqrtBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
     SuperscriptBox["z", "2"]}]], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "r"}], ")"}], " ", 
    RowBox[{"ArcCot", "[", 
     FractionBox[
      RowBox[{"1", "+", "r"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["n", "2"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "r"}], ")"}], "2"]}]]], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "r"}], ")"}], " ", 
    RowBox[{"ArcCot", "[", 
     FractionBox[
      RowBox[{"1", "+", "r"}], 
      SqrtBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
        SuperscriptBox["z", "2"]}]]], "]"}]}]}], 
  RowBox[{
   RowBox[{"-", "n"}], "+", "z"}]]], "Output",
 CellChangeTimes->{
  3.819743647661607*^9, 3.8197437068834133`*^9, 3.8197437933926077`*^9, 
   3.819744510338216*^9, 3.8197445547938013`*^9, 3.819744650461437*^9, 
   3.8197447322642927`*^9, 3.819744775519904*^9, 3.8197448339039803`*^9, 
   3.819745688610157*^9, 3.819800003267037*^9, 3.819802662035638*^9, 
   3.8198029406161633`*^9, 3.819803539320466*^9, 3.819804312820896*^9, 
   3.819804592668748*^9, 3.819805189735121*^9, {3.81980528463697*^9, 
   3.819805355673802*^9}, {3.819805387305986*^9, 3.819805429246834*^9}, 
   3.8198054828260527`*^9, 3.8198085157399197`*^9, 3.819809536351281*^9, {
   3.819809849952962*^9, 3.8198098948337297`*^9}, 3.819809927200262*^9, 
   3.819813108194152*^9},
 CellLabel->
  "Out[1236]=",ExpressionUUID->"3f26b217-4b6a-4554-b3f9-adadaf9b4ec1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"f1", " ", "=", " ", 
  RowBox[{"Factor", "[", 
   RowBox[{"simplifiedNoTrig", ",", 
    RowBox[{"Extension", "\[Rule]", "Automatic"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"f2", " ", "=", " ", 
  RowBox[{"ReplaceRepeated", "[", 
   RowBox[{"f1", ",", " ", "simplifiers"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"f3", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", "f2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"f4", " ", "=", " ", 
  RowBox[{"ReplaceRepeated", "[", 
   RowBox[{"f3", ",", " ", "simplifiers"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<test equality\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "f1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", "f4", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", "f1", "]"}], " ", "==", 
  RowBox[{"FullSimplify", "[", "f4", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"f1", "\[Equal]", "f4"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\</test\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Final Result\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"f5", " ", "=", " ", 
  RowBox[{"ReplaceRepeated", "[", 
   RowBox[{"f4", ",", " ", "replacements"}], "]"}]}], "\[IndentingNewLine]"}],\
 "Input",
 CellChangeTimes->{{3.819743816570384*^9, 3.819743817930648*^9}, {
   3.819743900819572*^9, 3.819743921726466*^9}, 3.819744846153654*^9, {
   3.8197456064969673`*^9, 3.819745638085305*^9}, {3.819800207263529*^9, 
   3.819800207364938*^9}, {3.819806299300775*^9, 3.819806300442309*^9}, {
   3.8198063326818743`*^9, 3.819806353502688*^9}, {3.81980646013888*^9, 
   3.819806464581353*^9}, {3.8198066122318077`*^9, 3.819806615478395*^9}, {
   3.819806663988626*^9, 3.819806693433835*^9}, {3.819806915151535*^9, 
   3.819806924533285*^9}, {3.819807009142861*^9, 3.819807023630829*^9}, {
   3.819807060448574*^9, 3.8198070649053917`*^9}, {3.819807197990574*^9, 
   3.819807198361364*^9}, {3.8198073079812717`*^9, 3.819807329069778*^9}, {
   3.819809572064075*^9, 3.819809587476261*^9}, {3.81980995472195*^9, 
   3.819809972846957*^9}, {3.8198100090075293`*^9, 3.819810098787067*^9}, {
   3.819813122253915*^9, 3.819813207026599*^9}, {3.819813391487215*^9, 
   3.819813420472314*^9}, {3.819813598449263*^9, 3.8198135994547567`*^9}, {
   3.819814258265971*^9, 3.8198142595272417`*^9}, {3.819814292374642*^9, 
   3.819814324219061*^9}, {3.819814368990814*^9, 3.819814395511958*^9}, {
   3.819814448857348*^9, 3.8198144543253307`*^9}, 3.819814794374765*^9, {
   3.819814828049551*^9, 3.8198148385300837`*^9}},
 CellLabel->
  "In[1497]:=",ExpressionUUID->"ec337bc1-f5f3-4555-8684-5f61070adacd"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"n", "-", "z"}]], 
  RowBox[{"(", 
   RowBox[{"n", "-", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["n", "2"], "-", 
      RowBox[{"2", " ", "r"}], "-", 
      SuperscriptBox["r", "2"]}]], "-", "z", "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", "r"}], "-", 
      SuperscriptBox["r", "2"], "+", 
      SuperscriptBox["z", "2"]}]], "+", 
    RowBox[{"ArcCot", "[", 
     FractionBox[
      RowBox[{"1", "+", "r"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["n", "2"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "r"}], ")"}], "2"]}]]], "]"}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"ArcCot", "[", 
      FractionBox[
       RowBox[{"1", "+", "r"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["n", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "r"}], ")"}], "2"]}]]], "]"}]}], "-", 
    RowBox[{"ArcCot", "[", 
     FractionBox[
      RowBox[{"1", "+", "r"}], 
      SqrtBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
        SuperscriptBox["z", "2"]}]]], "]"}], "-", 
    RowBox[{"r", " ", 
     RowBox[{"ArcCot", "[", 
      FractionBox[
       RowBox[{"1", "+", "r"}], 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
         SuperscriptBox["z", "2"]}]]], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.819814839509913*^9},
 CellLabel->
  "Out[1497]=",ExpressionUUID->"9d1b391d-96de-4e77-bea1-fecf1690f0af"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"n", "-", "z"}]], 
  RowBox[{"(", 
   RowBox[{"n", "-", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], "-", "z", "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]], "+", 
    RowBox[{"ArcTan", "[", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], 
      RowBox[{"1", "+", "r"}]], "]"}], "+", 
    RowBox[{"r", " ", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], 
       RowBox[{"1", "+", "r"}]], "]"}]}], "-", 
    RowBox[{"ArcTan", "[", 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]], 
      RowBox[{"1", "+", "r"}]], "]"}], "-", 
    RowBox[{"r", " ", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]], 
       RowBox[{"1", "+", "r"}]], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.8198148395183783`*^9},
 CellLabel->
  "Out[1498]=",ExpressionUUID->"a023365c-59d2-4364-be43-cb884e58e0bd"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"n", "-", "z"}]], 
  RowBox[{"(", 
   RowBox[{"n", "-", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], "-", "z", "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
      SuperscriptBox["z", "2"]}]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"ArcCot", "[", 
      FractionBox[
       RowBox[{"1", "+", "r"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["n", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "r"}], ")"}], "2"]}]]], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"ArcCot", "[", 
      FractionBox[
       RowBox[{"1", "+", "r"}], 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
         SuperscriptBox["z", "2"]}]]], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.8198148395269403`*^9},
 CellLabel->
  "Out[1499]=",ExpressionUUID->"168bc0ee-f59f-4e43-8454-14d9f22bf887"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"n", "-", "z"}]], 
  RowBox[{"(", 
   RowBox[{"n", "-", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], "-", "z", "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], 
       RowBox[{"1", "+", "r"}]], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"ArcTan", "[", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", "r", "+", "z"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "r", "+", "z"}], ")"}]}]], 
       RowBox[{"1", "+", "r"}]], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.819814839535733*^9},
 CellLabel->
  "Out[1500]=",ExpressionUUID->"e0b9413b-ba82-4c02-ab02-28f511d3a972"],

Cell[BoxData["\<\"test equality\"\>"], "Print",
 CellChangeTimes->{
  3.819814324900975*^9, {3.819814378122117*^9, 3.8198143971354437`*^9}, 
   3.819814455760786*^9, 3.819814608596594*^9, 3.8198146849549303`*^9, 
   3.8198148395443983`*^9},
 CellLabel->
  "During evaluation of \
In[1497]:=",ExpressionUUID->"696d98f9-b8a9-4617-9a2c-76fe159e3c0f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"n", "-", "z"}]], 
  RowBox[{"(", 
   RowBox[{"n", "-", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], "-", "z", "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
      SuperscriptBox["z", "2"]}]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"ArcCot", "[", 
      FractionBox[
       RowBox[{"1", "+", "r"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["n", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "r"}], ")"}], "2"]}]]], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"ArcCot", "[", 
      FractionBox[
       RowBox[{"1", "+", "r"}], 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
         SuperscriptBox["z", "2"]}]]], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.8198148395508204`*^9},
 CellLabel->
  "Out[1502]=",ExpressionUUID->"5e1812f4-4c43-47d9-b2a4-a8592b1314cb"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"n", "-", "z"}]], 
  RowBox[{"(", 
   RowBox[{"n", "-", 
    SqrtBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], "-", "z", "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
      SuperscriptBox["z", "2"]}]], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"ArcCot", "[", 
      FractionBox[
       RowBox[{"1", "+", "r"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["n", "2"], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "r"}], ")"}], "2"]}]]], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "r"}], ")"}], " ", 
     RowBox[{"ArcCot", "[", 
      FractionBox[
       RowBox[{"1", "+", "r"}], 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
         SuperscriptBox["z", "2"]}]]], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.819814839559622*^9},
 CellLabel->
  "Out[1503]=",ExpressionUUID->"9b85740e-95d7-422a-8433-d1d4d76b884b"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.81981483956894*^9},
 CellLabel->
  "Out[1504]=",ExpressionUUID->"b053dfe4-02fe-43ff-a2eb-8776e6526564"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "r"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
          SuperscriptBox["z", "2"]}]], " ", 
        RowBox[{"ArcCot", "[", 
         FractionBox[
          RowBox[{"1", "+", "r"}], 
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"-", "1"}], "-", "r", "+", "z"}]], " ", 
           SqrtBox[
            RowBox[{"1", "+", "r", "+", "z"}]]}]], "]"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          RowBox[{"-", "1"}], "-", "r", "+", "z"}]], " ", 
        SqrtBox[
         RowBox[{"1", "+", "r", "+", "z"}]]}]], "-", 
      RowBox[{"ArcCot", "[", 
       FractionBox[
        RowBox[{"1", "+", "r"}], 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", "r"}], ")"}], "2"]}], "+", 
          SuperscriptBox["z", "2"]}]]], "]"}]}], ")"}]}], 
   RowBox[{"n", "-", "z"}]], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.8198148395798807`*^9},
 CellLabel->
  "Out[1505]=",ExpressionUUID->"b8b9c9f6-e403-447d-a9e1-2d5a44216516"],

Cell[CellGroupData[{

Cell[BoxData["\<\"/test\"\>"], "Print",
 CellChangeTimes->{
  3.819814324900975*^9, {3.819814378122117*^9, 3.8198143971354437`*^9}, 
   3.819814455760786*^9, 3.819814608596594*^9, 3.8198146849549303`*^9, 
   3.819814839588778*^9},
 CellLabel->
  "During evaluation of \
In[1497]:=",ExpressionUUID->"1eaef2bf-dce2-47e4-94f4-c187eb6eb80d"],

Cell[BoxData["\<\"Final Result\"\>"], "Print",
 CellChangeTimes->{
  3.819814324900975*^9, {3.819814378122117*^9, 3.8198143971354437`*^9}, 
   3.819814455760786*^9, 3.819814608596594*^9, 3.8198146849549303`*^9, 
   3.819814839594837*^9},
 CellLabel->
  "During evaluation of \
In[1497]:=",ExpressionUUID->"b87444f1-a9a8-44d7-a32c-1111334516e1"]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "A"}], "+", "B", "+", "C", "+", 
   RowBox[{"D", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ArcTan", "[", 
       FractionBox["A", "D"], "]"}], "-", 
      RowBox[{"ArcTan", "[", 
       FractionBox["B", "D"], "]"}]}], ")"}]}]}], "C"]], "Output",
 CellChangeTimes->{{3.819745291102314*^9, 3.819745302241638*^9}, 
   3.819745362944537*^9, 3.8197455377378597`*^9, {3.819745617511979*^9, 
   3.819745638718103*^9}, 3.819800010860862*^9, {3.8198002081146584`*^9, 
   3.819800221069488*^9}, 3.819800265719203*^9, {3.819800300096427*^9, 
   3.8198003269359837`*^9}, 3.819800388746087*^9, 3.8198008061188297`*^9, 
   3.819800914843615*^9, 3.819802670724532*^9, 3.8198043199775457`*^9, 
   3.819804598079296*^9, 3.819804680831427*^9, 3.819805576246207*^9, 
   3.8198056513215*^9, 3.819805681413392*^9, 3.819805874317124*^9, 
   3.8198059139134693`*^9, 3.819806301158617*^9, {3.819806334815297*^9, 
   3.819806354182369*^9}, 3.819806465953115*^9, 3.8198066159965057`*^9, 
   3.819806712548605*^9, 3.819806926256208*^9, 3.819807024613811*^9, {
   3.819807055309946*^9, 3.819807092089134*^9}, 3.819807199376628*^9, {
   3.819807297003748*^9, 3.8198073296849127`*^9}, 3.8198085264305277`*^9, 
   3.8198095387074757`*^9, 3.819809588043572*^9, 3.819809973720776*^9, {
   3.819810022643795*^9, 3.819810100030795*^9}, {3.819813149779317*^9, 
   3.8198131803360653`*^9}, 3.81981321352691*^9, 3.8198133067598248`*^9, 
   3.8198134271911182`*^9, 3.819813505541965*^9, 3.819813552599709*^9, {
   3.8198135851107607`*^9, 3.819813600233884*^9}, 3.8198141366462507`*^9, 
   3.819814267729888*^9, 3.819814324867517*^9, {3.8198143780891447`*^9, 
   3.819814397103559*^9}, 3.819814455723762*^9, 3.819814608563286*^9, 
   3.819814684920772*^9, 3.8198148396011*^9},
 CellLabel->
  "Out[1508]=",ExpressionUUID->"5d7ec7ff-db17-4a8b-945b-d9dd0f90a183"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"ArcCot", "[", 
    FractionBox[
     RowBox[{"1", "+", "r"}], 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]]], "]"}], " ", "\[Equal]", 
   "  ", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n", "-", "r"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "n", "+", "r"}], ")"}]}]], 
     RowBox[{"1", "+", "r"}]], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.819800049315421*^9, 3.819800080571855*^9}, {
   3.819800361221115*^9, 3.819800365646852*^9}, {3.819800412046556*^9, 
   3.8198004627485657`*^9}, 3.819800508691682*^9, {3.8198005688725224`*^9, 
   3.8198005797043867`*^9}, {3.8198006105344687`*^9, 
   3.8198006493147793`*^9}, {3.819800684753669*^9, 3.819800699190486*^9}, {
   3.8198007435561037`*^9, 3.819800772541191*^9}, {3.819800823966732*^9, 
   3.8198008435593967`*^9}, {3.819800875404544*^9, 3.819800889861395*^9}, {
   3.8198009458846292`*^9, 3.819800971595273*^9}, {3.819801007628726*^9, 
   3.819801072120174*^9}, {3.819801130229253*^9, 3.8198011512314377`*^9}, {
   3.819801188236929*^9, 3.819801202273739*^9}, {3.819801909517356*^9, 
   3.8198019239867163`*^9}, {3.819801984578348*^9, 3.8198020022369328`*^9}, {
   3.819802709653618*^9, 3.819802722413678*^9}, {3.81980276041075*^9, 
   3.8198027685520763`*^9}, 3.819802982647889*^9, {3.8198030445575933`*^9, 
   3.819803089664431*^9}, {3.819803155991961*^9, 3.819803170294425*^9}, {
   3.819803226003976*^9, 3.819803349813118*^9}, {3.819803388578017*^9, 
   3.819803388886795*^9}, {3.819803433669853*^9, 3.819803443120257*^9}, {
   3.819803568746168*^9, 3.819803571284639*^9}, {3.819804007399921*^9, 
   3.819804022431353*^9}, {3.8198040709338627`*^9, 3.819804095174706*^9}, {
   3.8198042039621763`*^9, 3.819804227787816*^9}, {3.819804744959537*^9, 
   3.819804768660184*^9}, {3.819805537558837*^9, 3.8198055469784946`*^9}, 
   3.819805611596747*^9, {3.8198057686798553`*^9, 3.8198057783601503`*^9}, {
   3.819805820132119*^9, 3.8198058421002274`*^9}, {3.819805888311713*^9, 
   3.819805891157003*^9}, {3.819807592460081*^9, 3.819807604271389*^9}, {
   3.819807711381649*^9, 3.819807780789551*^9}, {3.8198078235438633`*^9, 
   3.81980792911762*^9}, {3.819807960226623*^9, 3.8198079780514097`*^9}, {
   3.819808099487998*^9, 3.819808142792864*^9}, {3.819808185542254*^9, 
   3.8198082170673103`*^9}, {3.819808721481893*^9, 3.819808780783724*^9}, {
   3.8198088128362207`*^9, 3.819808915025961*^9}, {3.8198090496415787`*^9, 
   3.819809049965192*^9}, {3.819809116705748*^9, 3.819809125509089*^9}, {
   3.819809164054254*^9, 3.819809201362008*^9}, {3.819809243659266*^9, 
   3.819809274235898*^9}, {3.8198096301972313`*^9, 3.819809656052833*^9}, {
   3.81981368644871*^9, 3.819813763005104*^9}, {3.819813901979837*^9, 
   3.819813952092475*^9}},
 CellLabel->
  "In[1388]:=",ExpressionUUID->"cbfc906a-d74a-4f7c-8dd1-f9f26ab98329"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.819807766547861*^9, 3.819807781611636*^9}, {
   3.819807824961319*^9, 3.819807929750132*^9}, {3.819807961636588*^9, 
   3.8198079784758387`*^9}, 3.819808146795587*^9, {3.819808186762278*^9, 
   3.819808211619795*^9}, 3.8198086035405903`*^9, {3.819808728513372*^9, 
   3.819808754624753*^9}, {3.8198088178198547`*^9, 3.819808915394532*^9}, 
   3.819809051620989*^9, {3.819809121725*^9, 3.819809126067574*^9}, {
   3.819809165242649*^9, 3.819809201910124*^9}, {3.819809245607366*^9, 
   3.819809274672543*^9}, 3.819809657982286*^9, 3.819813692686952*^9, {
   3.8198137579424267`*^9, 3.819813763640828*^9}, 3.819813906461918*^9, 
   3.819813954105659*^9},
 CellLabel->
  "Out[1388]=",ExpressionUUID->"066350e8-1bf3-4397-b806-38d91e3ca2d9"]
}, Open  ]]
},
WindowSize->{808, 828},
WindowMargins->{{28, Automatic}, {36, Automatic}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9a06dc96-d3d4-4ed9-8954-3c489c29e491"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 9657, 244, 699, "Input",ExpressionUUID->"8cbcca89-dd83-403d-b485-37075ac2cd63"],
Cell[10240, 268, 1353, 29, 34, "Output",ExpressionUUID->"c944f348-52e8-4d44-8ba0-9f62cab65ad4"],
Cell[11596, 299, 4754, 144, 164, "Output",ExpressionUUID->"b2143da3-d971-474a-8292-52053f71750f"],
Cell[16353, 445, 1646, 38, 38, "Output",ExpressionUUID->"f9433766-f49b-4b7d-ae5e-ac2620cc4f03"],
Cell[18002, 485, 5353, 164, 194, "Output",ExpressionUUID->"6b170154-0f2a-494a-b236-06fe905ac6b6"],
Cell[23358, 651, 1142, 18, 24, "Print",ExpressionUUID->"b09d4f75-5835-4e43-b5a8-d4d77c333955"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24537, 674, 1335, 27, 237, InheritFromParent,ExpressionUUID->"128ab600-be19-4870-bcf0-2171b8ac8045"],
Cell[25875, 703, 583, 14, 58, "Output",ExpressionUUID->"7fd6ee20-967f-4302-9629-ff025628878f"],
Cell[26461, 719, 422, 7, 24, "Print",ExpressionUUID->"ed327bb1-8da4-429a-b486-b2e40b75df35"],
Cell[26886, 728, 1432, 46, 82, "Output",ExpressionUUID->"729f67fb-ddaf-4df2-8e3f-7377cb04af3c"],
Cell[28321, 776, 1432, 46, 82, "Output",ExpressionUUID->"88905828-75f9-4298-b53b-7a59560dec0b"],
Cell[29756, 824, 425, 7, 24, "Print",ExpressionUUID->"c896b85f-87b2-4651-ae7a-2db844e298e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30218, 836, 880, 16, 48, "Input",ExpressionUUID->"4c229b05-061e-47f8-b766-32159dfaa5a5"],
Cell[31101, 854, 1951, 56, 64, "Output",ExpressionUUID->"3f26b217-4b6a-4554-b3f9-adadaf9b4ec1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33089, 915, 2724, 48, 283, InheritFromParent,ExpressionUUID->"ec337bc1-f5f3-4555-8684-5f61070adacd"],
Cell[35816, 965, 3231, 80, 112, "Output",ExpressionUUID->"9d1b391d-96de-4e77-bea1-fecf1690f0af"],
Cell[39050, 1047, 3410, 84, 145, "Output",ExpressionUUID->"a023365c-59d2-4364-be43-cb884e58e0bd"],
Cell[42463, 1133, 2832, 67, 109, "Output",ExpressionUUID->"168bc0ee-f59f-4e43-8454-14d9f22bf887"],
Cell[45298, 1202, 2906, 68, 103, "Output",ExpressionUUID->"e0b9413b-ba82-4c02-ab02-28f511d3a972"],
Cell[48207, 1272, 347, 7, 24, "Print",ExpressionUUID->"696d98f9-b8a9-4617-9a2c-76fe159e3c0f"],
Cell[48557, 1281, 2832, 67, 109, "Output",ExpressionUUID->"5e1812f4-4c43-47d9-b2a4-a8592b1314cb"],
Cell[51392, 1350, 2830, 67, 109, "Output",ExpressionUUID->"9b85740e-95d7-422a-8433-d1d4d76b884b"],
Cell[54225, 1419, 1607, 23, 34, "Output",ExpressionUUID->"b053dfe4-02fe-43ff-a2eb-8776e6526564"],
Cell[55835, 1444, 2820, 65, 79, "Output",ExpressionUUID->"b8b9c9f6-e403-447d-a9e1-2d5a44216516"],
Cell[CellGroupData[{
Cell[58680, 1513, 337, 7, 24, "Print",ExpressionUUID->"1eaef2bf-dce2-47e4-94f4-c187eb6eb80d"],
Cell[59020, 1522, 344, 7, 24, "Print",ExpressionUUID->"b87444f1-a9a8-44d7-a32c-1111334516e1"]
}, Open  ]],
Cell[59379, 1532, 1886, 33, 58, "Output",ExpressionUUID->"5d7ec7ff-db17-4a8b-945b-d9dd0f90a183"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61302, 1570, 3139, 58, 59, InheritFromParent,ExpressionUUID->"cbfc906a-d74a-4f7c-8dd1-f9f26ab98329"],
Cell[64444, 1630, 790, 12, 34, "Output",ExpressionUUID->"066350e8-1bf3-4397-b806-38d91e3ca2d9"]
}, Open  ]]
}
]
*)

